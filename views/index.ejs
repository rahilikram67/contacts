<!--Ejs basic template-->
<%-include('partials/header.ejs')%>
    <div class="w-100">
        <button onclick="openAddr()"
            class="mx-96 mt-48 py-2 px-4 font-semibold rounded-lg shadow-md text-white bg-green-500 hover:bg-green-700">
            Open Address Book
        </button>
        <pre id="output" class="border mt-5 mx-96 bg-purple-100 h-56 rounded overflow-auto"></pre>
    </div>
    <div class="absolute w-full h-full top-0 shader" hidden id="addressBook">
        <div class="md:mx-auto md:my-28 h-96 md:w-6/12 w-12/12 bg-purple-100 rounded">
            <!--container having all options-->
            <div id="withoutCSV">
                <div class="w-full text-center h-10 bg-blue-400 rounded-t">
                    <span class=" cursor-pointer ml-4 float-left text-white pt-1.5"
                        onclick="document.getElementById('addressBook').hidden=true">&lArr;</span>
                    <span class="text-2xl font-semibold text-white">Choose your address Book</span>
                    <span class=" cursor-pointer mr-2 float-right text-2xl text-white" onclick="cross()">&Cross;</span>
                </div>
                <div class="mt-3">
                    <div class="flex mx-auto">
                        <div id="googleBtn"
                            class="border cursor-pointer rounded bg-white ml-2 px-2 w-32 text-right hover:bg-green-500 hover:text-white">
                            <img src="public/assets/google.png" class="rounded-full float-left mt-0.5" width="50" height="50"
                                alt="">
                            <div class="my-3">Google</div>
                        </div>
                        <!-- <form id="yahoo" method="post" action="/yahoo" onclick="this.submit()"
                            class="border cursor-pointer rounded bg-white ml-2 px-2 w-32 text-right hover:bg-purple-500 hover:text-white">
                            <img src="/assets/yahoo.png" class="rounded-full float-left" width="50" height="50" alt="">
                            <div class="my-3">Yahoo</div>
                        </form>
                        <form id="office" method="post" action="/office" onclick="this.submit()"
                            class="border cursor-pointer rounded bg-white ml-2 px-2 w-28 text-right hover:bg-purple-300 hover:text-white">
                            <img src="/assets/office.png" class="rounded-full float-left mt-0.5" width="40" height="40"
                                alt="">
                            <div class="my-3">Office</div>
                        </form> -->
                        <div id="outlook" onclick="openOutlookCSV()"
                            class="border cursor-pointer rounded bg-white ml-2 px-2 w-32 text-right hover:bg-yellow-500 hover:text-white">
                            <img src="public/assets/outlook.jpg" class="rounded-full float-left mt-1" width="40" height="40"
                                alt="">
                            <div class="my-3">Outlook</div>
                        </div>
                        <div onclick="handleCSV()"
                            class="border cursor-pointer rounded bg-white ml-2 px-2 w-24 text-right hover:bg-pink-500 hover:text-white">
                            <img src="public/assets/csv.webp" class="rounded-full float-left mt-1" width="40" height="40"
                                alt="">
                            <div class="my-3">CSV</div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Container without options-->
            <div id="withCSV" hidden>
                <div class="w-full text-center h-10 bg-blue-400 rounded-t">
                    <span class=" cursor-pointer ml-4 float-left text-white pt-1.5"
                        onclick="roleBackCSV()">&lArr;</span>
                    <span class="text-2xl font-semibold text-white">Import your contacts</span>
                    <span class=" cursor-pointer mr-2 float-right text-2xl text-white" onclick="cross()">&Cross;</span>
                </div>
                <div class="mt-3 bg-purple-100">
                    <div class="ml-7 mt-10">Select and upload your contacts file</div>

                    <div onclick="uploadCSV()"
                        class="mx-7 mt-10 cursor-pointer hover:bg-gray-600  hover:text-white w-12/12 h-20 bg-white border-4 border-blue-500 border-dotted">
                        <div class="mt-5 text-center">Select to upload you file</div>
                    </div>
                    <div class="ml-7 pb-20 mt-1">Want to choose another address book? <span
                            class="text-blue-700 cursor-pointer" href="#" onclick="roleBackCSV()">click here</span>
                    </div>
                </div>
            </div>
            <!--container show imported contacts-->
            <div id="contacts" hidden>
                <div class="w-full text-center h-10 bg-blue-400 rounded-t">
                    <span class="cursor-pointer ml-4 float-left text-white pt-1.5"
                        onclick="roleBackContacts()">&lArr;</span>
                    <span class="text-2xl font-semibold text-white">Select Contacts</span>
                    <span class=" cursor-pointer mr-2 float-right text-2xl text-white" onclick="cross()">&Cross;</span>
                </div>
                <div class="bg-gray-300 py-1">
                    <span onclick="selectAll(event)" id="selectAll"
                        class="ml-10 text-blue-700 font-semibold cursor-pointer hover:text-blue-900">Select ALL</span>
                    <span hidden id="review" onclick="review(event)"
                        class="mr-10 text-blue-700 font-semibold cursor-pointer float-right hover:text-blue-900">Review</span>
                </div>
                <div class="mt-3 bg-purple-100" id="extendContacts"></div>
            </div>
            <button id="getContacts" hidden onclick="addContacts()"
                class="rounded float-right py-2 px-10 text-xl bg-yellow-500 text-white hover:bg-yellow-900 absolute right-0 getBtn">Get</button>

            <div id="contacts" hidden>
                <div class="w-full text-center h-10 bg-blue-400 rounded-t">
                    <span class="cursor-pointer ml-4 float-left text-white pt-1.5"
                        onclick="roleBackContacts()">&lArr;</span>
                    <span class="text-2xl font-semibold text-white">Select Contacts</span>
                    <span class=" cursor-pointer mr-2 float-right text-2xl text-white" onclick="cross()">&Cross;</span>
                </div>
                <div class="bg-gray-300 py-1">
                    <span onclick="selectAll(event)" id="selectAll"
                        class="ml-10 text-blue-700 font-semibold cursor-pointer hover:text-blue-900">Select ALL</span>
                    <span hidden id="review" onclick="review(event)"
                        class="mr-10 text-blue-700 font-semibold cursor-pointer float-right hover:text-blue-900">Review</span>
                </div>
                <div class="mt-3 bg-purple-100" id="extendContacts"></div>
            </div>
            <!--divider-->
            <div id="outlookCSV" hidden>
                <div class="w-full text-center h-10 bg-blue-400 rounded-t">
                    <span class="cursor-pointer ml-4 float-left text-white pt-1.5"
                        onclick="backOutlook()">&lArr;</span>
                    <span class="text-2xl font-semibold text-white">Import Contacts From CSV</span>
                    <span class="cursor-pointer mr-2 float-right text-2xl text-white" onclick="cross()">&Cross;</span>
                </div>
                <div onclick="window.open(`https://support.microsoft.com/en-us/office/export-contacts-from-outlook-10f09abd-643c-4495-bb80-543714eca73f`,'_blank')" 
                class="border bg-blue-500 cursor-pointer hover:bg-blue-900 flex w-48 my-5 py-2 ml-10 rounded">
                    <img width="30" height="30" class="mx-1" src="public/assets/outlook.jpg" alt="">
                    <span class="ml-1 text-white">Import Your contacts</span>
                </div>
                <div class="ml-10 mt-3 mr-20">
                    Click above to export and download your contacts to your computer.
                    You may have to sign in to your account.
                </div>
                <div class="ml-10 mt-4">
                    Select and upload your contacts file
                </div>
                <div onclick="uploadCSV()"
                        class="mx-7 mt-10 cursor-pointer hover:bg-gray-600  hover:text-white w-12/12 h-20 bg-white border-4 border-blue-500 border-dotted">
                        <div class="mt-5 text-center">Select to upload you file</div>
                </div>
            </div>
        </div>
    </div>
    <%-include('partials/footer.ejs')%>